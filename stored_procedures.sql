
-- CREATING THE PROCEDURE IN APPRORIATE DATA BASE
USE ENTERTAINMENT 
GO  -- BEGINS A NEW BATCH

CREATE PROCEDURE spProcTest
AS
-- BEGGINING OF PROCEDURE
BEGIN 
SELECT 
    CountryName,
    SUM(FilmRunTimeMinutes) AS TotalRuntime
    AVG(FilmRunTimeMinutes) AS AvgRuntime

FROM 
    tbl1Country AS c
    INNER JOIN tb1Film as f ON c.CountryID = f.FilmID 

GROUP BY 
    CountryName
ORDER BY
    CountryName ASC
-- END OF PROCEDURE
END 

-- EXECUTING STORED PROCEDURE
EXECUTE spProcTest

-- WE UPDATE THE PROCEDURE BY USING THE ALTER COMMAND

-- THE FOLLOWING COMMAND REMOVES THE STORED PROCEDURE
DROP PROCEDURE spProcTest